{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "siteName": {
            "type": "string",
            "metadata": {
                "description": "Name of the site into which the function should be deployed"
            }
        },
        "functionName": {
            "type": "string",
            "metadata": {
                "description": "name of the function"
            },
            "defaultValue": "AutomateLogListener"
        },
        "logAnalyticsWorkspaceID": {
            "type": "string",
            "metadata": {
                "description": "The workspace ID to use when adding data to Log Analytics"
            }
        },
        "logAnalyticsSharedKey": {
            "type": "securestring",
            "metadata": {
                "description": "Primary key to use for authentication to Log Analytics"
            }
        }
    },
    "variables": {
        "name": {
            "site": "[parameters('siteName')]",
            "function": "[parameters('functionName')]"
        },
        "apiVersions": {
            "functions": "2016-08-01"
        },
        "code": {
            "run_csx": "IwByACAAIgBOAGUAdwB0AG8AbgBzAG8AZgB0AC4ASgBzAG8AbgAiAA0ACgAjAGwAbwBhAGQAIAAiAHcAbwByAGsAcwBwAGEAYwBlAC4AYwBzAHgAIgANAAoAIwBsAG8AYQBkACAAIgBjAG8AbgBzAHQAYQBuAHQAcwAuAGMAcwB4ACIADQAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtADsADQAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4ATgBlAHQAOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAEgAdAB0AHAAOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAEgAdAB0AHAALgBIAGUAYQBkAGUAcgBzADsADQAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkAOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0ADsADQAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4AVABoAHIAZQBhAGQAaQBuAGcALgBUAGEAcwBrAHMAOwANAAoAdQBzAGkAbgBnACAATgBlAHcAdABvAG4AcwBvAGYAdAAuAEoAcwBvAG4AOwANAAoAdQBzAGkAbgBnACAATQBpAGMAcgBvAHMAbwBmAHQALgBXAGkAbgBkAG8AdwBzAEEAegB1AHIAZQAuAFMAdABvAHIAYQBnAGUALgBUAGEAYgBsAGUAOwANAAoAIAANAAoALwAvACAAQwBsAGEAcwBzACAAZgBvAHIAIAB3AGgAYQB0ACAAcwBoAG8AdQBsAGQAIABiAGUAIABzAGUAbgB0ACAAdABvACAATABvAGcAIABBAG4AYQBsAHkAdABpAGMAcwANAAoAcAB1AGIAbABpAGMAIABjAGwAYQBzAHMAIABOAG8AZABlAEMAbwB1AG4AdAANAAoAewANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdAByAGkAbgBnACAAUwBlAHIAdgBlAHIAQQBkAGQAcgBlAHMAcwAgAHsAIABnAGUAdAA7ACAAcwBlAHQAOwAgAH0ADQAKACAAIAAgACAAcAB1AGIAbABpAGMAIABzAHQAcgBpAG4AZwAgAFMAZQByAHYAZQByAFQAeQBwAGUAIAB7ACAAZwBlAHQAOwBzAGUAdAA7ACAAfQANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAGkAbgB0ACAAVABvAHQAYQBsACAAewAgAGcAZQB0ADsAIABzAGUAdAA7ACAAfQANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAGkAbgB0ACAAUwB1AGMAYwBlAHMAcwAgAHsAIABnAGUAdAA7ACAAcwBlAHQAOwAgAH0ADQAKACAAIAAgACAAcAB1AGIAbABpAGMAIABpAG4AdAAgAEYAYQBpAGwAdQByAGUAIAB7ACAAZwBlAHQAOwAgAHMAZQB0ADsAIAB9AA0ACgAgACAAIAAgAHAAdQBiAGwAaQBjACAAaQBuAHQAIABNAGkAcwBzAGkAbgBnACAAewAgAGcAZQB0ADsAIABzAGUAdAA7ACAAfQANAAoAfQANAAoAIAANAAoAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAHYAbwBpAGQAIABSAHUAbgAoAFQAaQBtAGUAcgBJAG4AZgBvACAAbQB5AFQAaQBtAGUAcgAsACAAQwBsAG8AdQBkAFQAYQBiAGwAZQAgAHMAZQB0AHQAaQBuAGcAVABhAGIAbABlACwAIABUAHIAYQBjAGUAVwByAGkAdABlAHIAIABsAG8AZwApAA0ACgB7AA0ACgAgACAAIAAgAGwAbwBnAC4ASQBuAGYAbwAoACIAUwB0AGEAcgB0ACAAZgB1AG4AYwB0AGkAbwBuACAAdABvACAAYQBkAGQAIABpAG4AZgBvAHIAbQBhAHQAaQBvAG4AIAB0AG8AIABMAG8AZwAgAEEAbgBhAGwAeQB0AGkAYwBzACIAKQA7AA0ACgAgAA0ACgAgACAAIAAgAC8ALwAgAEwAbwBnAE4AYQBtAGUAIABpAHMAIABuAGEAbQBlACAAbwBmACAAdABoAGUAIABlAHYAZQBuAHQAIAB0AHkAcABlACAAdABoAGEAdAAgAGkAcwAgAGIAZQBpAG4AZwAgAHMAdQBiAG0AaQB0AHQAZQBkACAAdABvACAATABvAGcAIABBAG4AYQBsAHkAdABpAGMAcwANAAoAIAAgACAAIABzAHQAcgBpAG4AZwAgAEwAbwBnAE4AYQBtAGUAIAA9ACAAIgBDAGgAZQBmAEEAdQB0AG8AbQBhAHQAZQBBAE0AQQBJAG4AZgByAGEATgBvAGQAZQBDAG8AdQBuAHQAIgA7AA0ACgANAAoAIAAgACAAIABSAGEAbgBkAG8AbQAgAGcAYQByAGIAYQBnAGUAIAA9ACAAbgBlAHcAIABSAGEAbgBkAG8AbQAoACkAOwANAAoAIAAgACAAIABzAHQAcgBpAG4AZwAgAFMAZQByAHYAZQByAFQAeQBwAGUAIAA9ACAAIgBBAHUAdABvAG0AYQB0AGUAIgA7AA0ACgAgACAAIAAgAHMAdAByAGkAbgBnACAAQQBkAGQAcgBlAHMAcwAgAD0AIAAiAGgAdAB0AHAAcwA6AC8ALwBvAHAAcwBjAGgAZQBmAGEAdQB0AG8AbQBhAHQAZQAuAHcAZQBzAHQALgBjAGUAbgB0AHIAYQBsAHUAcwAuAGMAbABvAHUAZABhAHAAcAAuAGEAegB1AHIAZQAuAGMAbwBtAC8AIgA7AA0ACgAgACAAIAAgAGkAZgAoAGcAYQByAGIAYQBnAGUALgBOAGUAeAB0ACgAMQAsADMAKQAgAD0APQAgADEAKQB7AA0ACgAgACAAIAAgAFMAZQByAHYAZQByAFQAeQBwAGUAIAA9ACAAIgBDAGgAZQBmACAAUwBlAHIAdgBlAHIAIgA7AA0ACgAgACAAIAAgAEEAZABkAHIAZQBzAHMAIAA9ACAAIgBoAHQAdABwAHMAOgAvAC8AbwBwAHMAYwBoAGUAZgBzAGUAcgB2AGUAcgAuAHcAZQBzAHQALgBjAGUAbgB0AHIAYQBsAHUAcwAuAGMAbABvAHUAZABhAHAAcAAuAGEAegB1AHIAZQAuAGMAbwBtAC8AIgA7AA0ACgAgACAAIAAgAH0ADQAKAA0ACgAgACAAIAAgAGwAbwBnAC4ASQBuAGYAbwAoACIAUwBlAHIAdgBlAHIAIABUAHkAcABlACAAaQBzACAAIgAgACsAIABTAGUAcgB2AGUAcgBUAHkAcABlACAAKwAgACIAIABhAG4AZAAgAGEAZABkAHIAZQBzAHMAIABpAHMAIAAiACAAKwAgAEEAZABkAHIAZQBzAHMAKQA7AA0ACgANAAoAIAAgACAAIAAvAC8AIABHAGUAdAAgAHQAaABlACAAYQB1AHQAbwBtAGEAdABlACAAdABvAGsAZQBuACAAZgByAG8AbQAgAHQAaABlACAAYwBvAG4AZgBpAGcAIABzAHQAbwByAGUAIAB0AGEAYgBsAGUADQAKACAAIAAgACAALwAvACAAYQBuAGQAIAB0AGgAZQAgAGEAdQB0AG8AbQBhAHQAZQAgAEYAUQBEAE4ADQAKACAAIAAgACAAVABhAGIAbABlAE8AcABlAHIAYQB0AGkAbwBuACAAbwBwAGUAcgBhAHQAaQBvAG4AIAA9ACAAVABhAGIAbABlAE8AcABlAHIAYQB0AGkAbwBuAC4AUgBlAHQAcgBpAGUAdgBlADwAQwBvAG4AZgBpAGcASwBWAD4AKABQAGEAcgB0AGkAdABpAG8AbgBLAGUAeQAsACAAQQB1AHQAbwBtAGEAdABlAFQAbwBrAGUAbgBLAGUAeQBOAGEAbQBlACkAOwANAAoAIAAgACAAIABUAGEAYgBsAGUAUgBlAHMAdQBsAHQAIAB0AG8AawBlAG4AXwByAGUAcwB1AGwAdAAgAD0AIABzAGUAdAB0AGkAbgBnAFQAYQBiAGwAZQAuAEUAeABlAGMAdQB0AGUAKABvAHAAZQByAGEAdABpAG8AbgApADsADQAKAA0ACgAgACAAIAAgAFQAYQBiAGwAZQBPAHAAZQByAGEAdABpAG8AbgAgAG8AcABlAHIAYQB0AGkAbwBuACAAPQAgAFQAYQBiAGwAZQBPAHAAZQByAGEAdABpAG8AbgAuAFIAZQB0AHIAaQBlAHYAZQA8AEMAbwBuAGYAaQBnAEsAVgA+ACgAUABhAHIAdABpAHQAaQBvAG4ASwBlAHkALAAgAEEAdQB0AG8AbQBhAHQAZQBGAFEARABOAEsAZQB5AE4AYQBtAGUAKQA7AA0ACgAgACAAIAAgAFQAYQBiAGwAZQBSAGUAcwB1AGwAdAAgAGYAcQBkAG4AXwByAGUAcwB1AGwAdAAgAD0AIABzAGUAdAB0AGkAbgBnAFQAYQBiAGwAZQAuAEUAeABlAGMAdQB0AGUAKABvAHAAZQByAGEAdABpAG8AbgApADsADQAKAA0ACgAgACAAIAAgAC8ALwAgAGkAZgAgAHQAaABlAHIAZQAgAGkAcwAgAGEAIAByAGUAcwB1AGwAdAAgAGcAZQB0ACAAdABoAGUAIABrAGUAeQAgAHYAYQBsAHUAZQAsACAAbwB0AGgAZQByAHcAaQBzAGUAIABsAG8AZwAgAGUAcgByAG8AcgANAAoAIAAgACAAIABpAGYAIAAoAHQAbwBrAGUAbgBfAHIAZQBzAHUAbAB0AC4AUgBlAHMAdQBsAHQAIAAhAD0AIABuAHUAbABsACAAJgAmACAAZgBxAGQAbgBfAHIAZQBzAHUAbAB0AC4AUgBlAHMAdQBsAHQAIAAhAD0AIAApACAAewANAAoADQAKACAAIAAgACAAIAAgACAAIAAvAC8AIABnAGUAdAAgAHQAaABlACAAdABvAGsAZQBuACAAdgBhAGwAdQBlAA0ACgAgACAAIAAgACAAIAAgACAAQwBvAG4AZgBpAGcASwBWACAAdABvAGsAZQBuAF8AcwBlAHQAdABpAG4AZwAgAD0AIAAoAEMAbwBuAGYAaQBnAEsAVgApAHQAbwBrAGUAbgBfAHIAZQBzAHUAbAB0AC4AUgBlAHMAdQBsAHQAOwANAAoAIAAgACAAIAAgACAAIAAgAEMAbwBuAGYAaQBnAEsAVgAgAGYAcQBkAG4AXwBzAGUAdAB0AGkAbgBnACAAPQAgACgAQwBvAG4AZgBpAGcASwBWACkAZgBxAGQAbgBfAHIAZQBzAHUAbAB0AC4AUgBlAHMAdQBsAHQAOwANAAoAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAYQB1AHQAbwBtAGEAdABlAF8AdABvAGsAZQBuACAAPQAgAHQAbwBrAGUAbgBfAHMAZQB0AHQAaQBuAGcALgBWAGEAbAB1AGUAOwANAAoAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAYQB1AHQAbwBtAGEAdABlAF8AZgBxAGQAbgAgAD0AIABmAHEAZABuAF8AcwBlAHQAdABpAG4AZwAuAFYAYQBsAHUAZQA7AA0ACgANAAoAIAAgACAAIAAgACAAIAAgAC8ALwAgAEMAcgBlAGEAdABlAHMAIAB0AGgAZQAgAEoAUwBPAE4AIABvAGIAagBlAGMAdAAsACAAdwBpAHQAaAAgAGsAZQB5AC8AdgBhAGwAdQBlACAAcABhAGkAcgBzAA0ACgAgACAAIAAgACAAIAAgACAAbABvAGcALgBJAG4AZgBvACgARwBlAHQAUwB0AHIAaQBuAGcARABhAHQAYQAoAGwAbwBnACwAIABhAHUAdABvAG0AYQB0AGUAXwBmAHEAZABuACwAIABhAHUAdABvAG0AYQB0AGUAXwB0AG8AawBlAG4AKQApADsADQAKACAAIAAgACAAIAAgACAAIABOAG8AZABlAEMAbwB1AG4AdAAgAGoAcwBvAG4ATwBiAGoAIAA9ACAAbgBlAHcAIABOAG8AZABlAEMAbwB1AG4AdAAoACkAOwANAAoAIAAgACAAIAAgACAAIAAgAGoAcwBvAG4ATwBiAGoAIAA9ACAARwBlAHQARABhAHQAYQAoAGEAdQB0AG8AbQBhAHQAZQBfAGYAcQBkAG4ALAAgAGEAdQB0AG8AbQBhAHQAZQBfAHQAbwBrAGUAbgApADsADQAKACAAIAAgACAAIAAgACAAIABqAHMAbwBuAE8AYgBqAC4AUwBlAHIAdgBlAHIAVAB5AHAAZQAgAD0AIABTAGUAcgB2AGUAcgBUAHkAcABlADsADQAKACAAIAAgACAAIAAgACAAIABqAHMAbwBuAE8AYgBqAC4AUwBlAHIAdgBlAHIAQQBkAGQAcgBlAHMAcwAgAD0AIABBAGQAZAByAGUAcwBzADsADQAKACAAIAAgACAAIAAgACAAIAAvAC8AIABDAG8AbgB2AGUAcgB0ACAAbwBiAGoAZQBjAHQAIAB0AG8AIABqAHMAbwBuAA0ACgAgACAAIAAgACAAIAAgACAAdgBhAHIAIABqAHMAbwBuACAAPQAgAEoAcwBvAG4AQwBvAG4AdgBlAHIAdAAuAFMAZQByAGkAYQBsAGkAegBlAE8AYgBqAGUAYwB0ACgAagBzAG8AbgBPAGIAagApADsADQAKACAAIAAgACAADQAKACAAIAAgACAAIAAgACAAIABsAG8AZwAuAEkAbgBmAG8AKAAiAGoAcwBvAG4AIABmAGkAbABlACAAcwBlAG4AdAAgAHQAbwAgAEwAbwBnACAAQQBuAGEAbAB5AHQAaQBjAHMAOgAgACIAIAArACAAagBzAG8AbgApADsADQAKACAAIAAgACAAIAAgACAAIAANAAoAIAAgACAAIAAgACAAIAAgAC8ALwAgAEMAcgBlAGEAdABlACAAYQAgAGgAYQBzAGgAIABmAG8AcgAgAHQAaABlACAAQQBQAEkAIABzAGkAZwBuAGEAdAB1AHIAZQANAAoAIAAgACAAIAAgACAAIAAgAHYAYQByACAAZABhAHQAZQBzAHQAcgBpAG4AZwAgAD0AIABEAGEAdABlAFQAaQBtAGUALgBVAHQAYwBOAG8AdwAuAFQAbwBTAHQAcgBpAG4AZwAoACIAcgAiACkAOwANAAoAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAcwB0AHIAaQBuAGcAVABvAEgAYQBzAGgAIAA9ACAAIgBQAE8AUwBUAFwAbgAiACAAKwAgAGoAcwBvAG4ALgBMAGUAbgBnAHQAaAAgACsAIAAiAFwAbgBhAHAAcABsAGkAYwBhAHQAaQBvAG4ALwBqAHMAbwBuAFwAbgAiACAAKwAgACIAeAAtAG0AcwAtAGQAYQB0AGUAOgAiACAAKwAgAGQAYQB0AGUAcwB0AHIAaQBuAGcAIAArACAAIgBcAG4ALwBhAHAAaQAvAGwAbwBnAHMAIgA7AA0ACgAgACAAIAAgACAAIAAgACAAcwB0AHIAaQBuAGcAIABoAGEAcwBoAGUAZABTAHQAcgBpAG4AZwAgAD0AIABCAHUAaQBsAGQAUwBpAGcAbgBhAHQAdQByAGUAKABzAHQAcgBpAG4AZwBUAG8ASABhAHMAaAAsACAAcwBoAGEAcgBlAGQASwBlAHkAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAcwB0AHIAaQBuAGcAIABzAGkAZwBuAGEAdAB1AHIAZQAgAD0AIAAiAFMAaABhAHIAZQBkAEsAZQB5ACAAIgAgACsAIABjAHUAcwB0AG8AbQBlAHIASQBkACAAKwAgACIAOgAiACAAKwAgAGgAYQBzAGgAZQBkAFMAdAByAGkAbgBnADsADQAKACAAIAAgACAADQAKACAAIAAgACAAIAAgACAAIABQAG8AcwB0AEQAYQB0AGEAKABzAGkAZwBuAGEAdAB1AHIAZQAsACAAZABhAHQAZQBzAHQAcgBpAG4AZwAsACAAagBzAG8AbgAsACAAYwB1AHMAdABvAG0AZQByAEkAZAAsACAATABvAGcATgBhAG0AZQApADsADQAKACAAIAAgACAAfQAgAGUAbABzAGUAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAbABvAGcALgBJAG4AZgBvACgAUwB0AHIAaQBuAGcALgBGAG8AcgBtAGEAdAAoACIAVQBuAGEAYgBsAGUAIAB0AG8AIABmAGkAbgBkACAAcwBlAGwAZQBjAHQAZQBkACAAdABvAGsAZQBuACAAaQBuACAAdABhAGIAbABlADoAIAB7ADAAfQAiACwAIABBAHUAdABvAG0AYQB0AGUAVABvAGsAZQBuAEsAZQB5AE4AYQBtAGUAKQApADsADQAKACAAIAAgACAAfQANAAoAfQANAAoAIAANAAoALwAvACAAQgB1AGkAbABkACAAdABoAGUAIABBAFAASQAgAHMAaQBnAG4AYQB0AHUAcgBlAA0ACgBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAcwB0AHIAaQBuAGcAIABCAHUAaQBsAGQAUwBpAGcAbgBhAHQAdQByAGUAKABzAHQAcgBpAG4AZwAgAG0AZQBzAHMAYQBnAGUALAAgAHMAdAByAGkAbgBnACAAcwBlAGMAcgBlAHQAKQANAAoAewANAAoAIAAgACAAIAB2AGEAcgAgAGUAbgBjAG8AZABpAG4AZwAgAD0AIABuAGUAdwAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKAApADsADQAKACAAIAAgACAAYgB5AHQAZQBbAF0AIABrAGUAeQBCAHkAdABlACAAPQAgAEMAbwBuAHYAZQByAHQALgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAcwBlAGMAcgBlAHQAKQA7AA0ACgAgACAAIAAgAGIAeQB0AGUAWwBdACAAbQBlAHMAcwBhAGcAZQBCAHkAdABlAHMAIAA9ACAAZQBuAGMAbwBkAGkAbgBnAC4ARwBlAHQAQgB5AHQAZQBzACgAbQBlAHMAcwBhAGcAZQApADsADQAKACAAIAAgACAAdQBzAGkAbgBnACAAKAB2AGEAcgAgAGgAbQBhAGMAcwBoAGEAMgA1ADYAIAA9ACAAbgBlAHcAIABIAE0AQQBDAFMASABBADIANQA2ACgAawBlAHkAQgB5AHQAZQApACkADQAKACAAIAAgACAAewANAAoAIAAgACAAIAAgACAAIAAgAGIAeQB0AGUAWwBdACAAaABhAHMAaAAgAD0AIABoAG0AYQBjAHMAaABhADIANQA2AC4AQwBvAG0AcAB1AHQAZQBIAGEAcwBoACgAbQBlAHMAcwBhAGcAZQBCAHkAdABlAHMAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAcgBlAHQAdQByAG4AIABDAG8AbgB2AGUAcgB0AC4AVABvAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAaABhAHMAaAApADsADQAKACAAIAAgACAAfQANAAoAfQANAAoAIAANAAoALwAvACAAUwBlAG4AZAAgAGEAIAByAGUAcQB1AGUAcwB0ACAAdABvACAAdABoAGUAIABQAE8AUwBUACAAQQBQAEkAIABlAG4AZABwAG8AaQBuAHQADQAKAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIAB2AG8AaQBkACAAUABvAHMAdABEAGEAdABhACgAcwB0AHIAaQBuAGcAIABzAGkAZwBuAGEAdAB1AHIAZQAsACAAcwB0AHIAaQBuAGcAIABkAGEAdABlACwAIABzAHQAcgBpAG4AZwAgAGoAcwBvAG4ALAAgAHMAdAByAGkAbgBnACAAYwB1AHMAdABvAG0AZQByAEkAZAAsACAAcwB0AHIAaQBuAGcAIABMAG8AZwBOAGEAbQBlACkADQAKAHsADQAKACAAIAAgACAALwAvACAAWQBvAHUAIABjAGEAbgAgAHUAcwBlACAAYQBuACAAbwBwAHQAaQBvAG4AYQBsACAAZgBpAGUAbABkACAAdABvACAAcwBwAGUAYwBpAGYAeQAgAHQAaABlACAAdABpAG0AZQBzAHQAYQBtAHAAIABmAHIAbwBtACAAdABoAGUAIABkAGEAdABhAC4AIABJAGYAIAB0AGgAZQAgAHQAaQBtAGUAIABmAGkAZQBsAGQAIABpAHMAIABuAG8AdAAgAHMAcABlAGMAaQBmAGkAZQBkACwAIABMAG8AZwAgAEEAbgBhAGwAeQB0AGkAYwBzACAAYQBzAHMAdQBtAGUAcwAgAHQAaABlACAAdABpAG0AZQAgAGkAcwAgAHQAaABlACAAbQBlAHMAcwBhAGcAZQAgAGkAbgBnAGUAcwB0AGkAbwBuACAAdABpAG0AZQANAAoAIAAgACAAIABzAHQAcgBpAG4AZwAgAFQAaQBtAGUAUwB0AGEAbQBwAEYAaQBlAGwAZAAgAD0AIAAiACIAOwANAAoAIAAgACAAIAB0AHIAeQANAAoAIAAgACAAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAcwB0AHIAaQBuAGcAIAB1AHIAbAAgAD0AIAAiAGgAdAB0AHAAcwA6AC8ALwAiACAAKwAgAGMAdQBzAHQAbwBtAGUAcgBJAGQAIAArACAAIgAuAG8AZABzAC4AbwBwAGkAbgBzAGkAZwBoAHQAcwAuAGEAegB1AHIAZQAuAGMAbwBtAC8AYQBwAGkALwBsAG8AZwBzAD8AYQBwAGkALQB2AGUAcgBzAGkAbwBuAD0AMgAwADEANgAtADAANAAtADAAMQAiADsADQAKACAADQAKACAAIAAgACAAIAAgACAAIABTAHkAcwB0AGUAbQAuAE4AZQB0AC4ASAB0AHQAcAAuAEgAdAB0AHAAQwBsAGkAZQBuAHQAIABjAGwAaQBlAG4AdAAgAD0AIABuAGUAdwAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBIAHQAdABwAC4ASAB0AHQAcABDAGwAaQBlAG4AdAAoACkAOwANAAoAIAAgACAAIAAgACAAIAAgAGMAbABpAGUAbgB0AC4ARABlAGYAYQB1AGwAdABSAGUAcQB1AGUAcwB0AEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAQQBjAGMAZQBwAHQAIgAsACAAIgBhAHAAcABsAGkAYwBhAHQAaQBvAG4ALwBqAHMAbwBuACIAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAYwBsAGkAZQBuAHQALgBEAGUAZgBhAHUAbAB0AFIAZQBxAHUAZQBzAHQASABlAGEAZABlAHIAcwAuAEEAZABkACgAIgBMAG8AZwAtAFQAeQBwAGUAIgAsACAATABvAGcATgBhAG0AZQApADsADQAKACAAIAAgACAAIAAgACAAIABjAGwAaQBlAG4AdAAuAEQAZQBmAGEAdQBsAHQAUgBlAHEAdQBlAHMAdABIAGUAYQBkAGUAcgBzAC4AQQBkAGQAKAAiAEEAdQB0AGgAbwByAGkAegBhAHQAaQBvAG4AIgAsACAAcwBpAGcAbgBhAHQAdQByAGUAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAYwBsAGkAZQBuAHQALgBEAGUAZgBhAHUAbAB0AFIAZQBxAHUAZQBzAHQASABlAGEAZABlAHIAcwAuAEEAZABkACgAIgB4AC0AbQBzAC0AZABhAHQAZQAiACwAIABkAGEAdABlACkAOwANAAoAIAAgACAAIAAgACAAIAAgAGMAbABpAGUAbgB0AC4ARABlAGYAYQB1AGwAdABSAGUAcQB1AGUAcwB0AEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAdABpAG0AZQAtAGcAZQBuAGUAcgBhAHQAZQBkAC0AZgBpAGUAbABkACIALAAgAFQAaQBtAGUAUwB0AGEAbQBwAEYAaQBlAGwAZAApADsADQAKACAADQAKACAAIAAgACAAIAAgACAAIABTAHkAcwB0AGUAbQAuAE4AZQB0AC4ASAB0AHQAcAAuAEgAdAB0AHAAQwBvAG4AdABlAG4AdAAgAGgAdAB0AHAAQwBvAG4AdABlAG4AdAAgAD0AIABuAGUAdwAgAFMAdAByAGkAbgBnAEMAbwBuAHQAZQBuAHQAKABqAHMAbwBuACwAIABFAG4AYwBvAGQAaQBuAGcALgBVAFQARgA4ACkAOwANAAoAIAAgACAAIAAgACAAIAAgAGgAdAB0AHAAQwBvAG4AdABlAG4AdAAuAEgAZQBhAGQAZQByAHMALgBDAG8AbgB0AGUAbgB0AFQAeQBwAGUAIAA9ACAAbgBlAHcAIABNAGUAZABpAGEAVAB5AHAAZQBIAGUAYQBkAGUAcgBWAGEAbAB1AGUAKAAiAGEAcABwAGwAaQBjAGEAdABpAG8AbgAvAGoAcwBvAG4AIgApADsADQAKACAAIAAgACAAIAAgACAAIABUAGEAcwBrADwAUwB5AHMAdABlAG0ALgBOAGUAdAAuAEgAdAB0AHAALgBIAHQAdABwAFIAZQBzAHAAbwBuAHMAZQBNAGUAcwBzAGEAZwBlAD4AIAByAGUAcwBwAG8AbgBzAGUAIAA9ACAAYwBsAGkAZQBuAHQALgBQAG8AcwB0AEEAcwB5AG4AYwAoAG4AZQB3ACAAVQByAGkAKAB1AHIAbAApACwAIABoAHQAdABwAEMAbwBuAHQAZQBuAHQAKQA7AA0ACgAgAA0ACgAgACAAIAAgACAAIAAgACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAEgAdAB0AHAALgBIAHQAdABwAEMAbwBuAHQAZQBuAHQAIAByAGUAcwBwAG8AbgBzAGUAQwBvAG4AdABlAG4AdAAgAD0AIAByAGUAcwBwAG8AbgBzAGUALgBSAGUAcwB1AGwAdAAuAEMAbwBuAHQAZQBuAHQAOwANAAoAIAAgACAAIAAgACAAIAAgAHMAdAByAGkAbgBnACAAcgBlAHMAdQBsAHQAIAA9ACAAcgBlAHMAcABvAG4AcwBlAEMAbwBuAHQAZQBuAHQALgBSAGUAYQBkAEEAcwBTAHQAcgBpAG4AZwBBAHMAeQBuAGMAKAApAC4AUgBlAHMAdQBsAHQAOwANAAoAIAAgACAAIAAgACAAIAAgAEMAbwBuAHMAbwBsAGUALgBXAHIAaQB0AGUATABpAG4AZQAoACIAUgBlAHQAdQByAG4AIABSAGUAcwB1AGwAdAA6ACAAIgAgACsAIAByAGUAcwB1AGwAdAApADsADQAKACAAIAAgACAAfQANAAoAIAAgACAAIABjAGEAdABjAGgAIAAoAEUAeABjAGUAcAB0AGkAbwBuACAAZQB4AGMAZQBwACkADQAKACAAIAAgACAAewANAAoAIAAgACAAIAAgACAAIAAgAEMAbwBuAHMAbwBsAGUALgBXAHIAaQB0AGUATABpAG4AZQAoACIAQQBQAEkAIABQAG8AcwB0ACAARQB4AGMAZQBwAHQAaQBvAG4AOgAgACIAIAArACAAZQB4AGMAZQBwAC4ATQBlAHMAcwBhAGcAZQApADsADQAKACAAIAAgACAAfQANAAoAfQANAAoADQAKAC8ALwAgAFMAZQBuAGQAIABhACAAcgBlAHEAdQBlAHMAdAAgAHQAbwAgAHQAaABlACAAUABPAFMAVAAgAEEAUABJACAAZQBuAGQAcABvAGkAbgB0AA0ACgBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAATgBvAGQAZQBDAG8AdQBuAHQAIABHAGUAdABEAGEAdABhACgAcwB0AHIAaQBuAGcAIABhAHUAdABvAG0AYQB0AGUAXwBmAHEAZABuACwAIABzAHQAcgBpAG4AZwAgAHQAbwBrAGUAbgApAA0ACgB7AA0ACgAgACAAIAAgAA0ACgAgACAAIAAgAE4AbwBkAGUAQwBvAHUAbgB0ACAAbgBvAGQAZQBDAG8AdQBuAHQAIAA9ACAAbgB1AGwAbAA7AA0ACgAgACAAIAAgAHQAcgB5AA0ACgAgACAAIAAgAHsADQAKACAAIAAgACAAIAAgACAAIABTAGUAcgB2AGkAYwBlAFAAbwBpAG4AdABNAGEAbgBhAGcAZQByAC4AUwBlAHIAdgBlAHIAQwBlAHIAdABpAGYAaQBjAGEAdABlAFYAYQBsAGkAZABhAHQAaQBvAG4AQwBhAGwAbABiAGEAYwBrACAAKwA9ACAAKABzAGUAbgBkAGUAcgAsACAAYwBlAHIAdAAsACAAYwBoAGEAaQBuACwAIABzAHMAbABQAG8AbABpAGMAeQBFAHIAcgBvAHIAcwApACAAPQA+ACAAdAByAHUAZQA7AA0ACgAgACAAIAAgACAAIAAgACAAcwB0AHIAaQBuAGcAIAB1AHIAbAAgAD0AIABTAHQAcgBpAG4AZwAuAGYAbwByAG0AYQB0ACgAIgBoAHQAdABwAHMAOgAvAC8AewAwAH0ALwBhAHAAaQAvAHYAMAAvAGMAZgBnAG0AZwBtAHQALwBzAHQAYQB0AHMALwBuAG8AZABlAF8AYwBvAHUAbgB0AHMAIgAsACAAYQB1AHQAbwBtAGEAdABlAF8AZgBxAGQAbgApADsADQAKACAAIAAgACAAIAAgACAAIABDAG8AbgBzAG8AbABlAC4AVwByAGkAdABlAEwAaQBuAGUAKAAiAFAAUgBFAFAAQQBSAEkATgBHACAAUgBFAFEAVQBFAFMAVAA9AD0APQA9AD0APQAiACkAOwANAAoAIAAgACAAIAAgACAAIAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBIAHQAdABwAC4ASAB0AHQAcABDAGwAaQBlAG4AdAAgAGMAbABpAGUAbgB0ACAAPQAgAG4AZQB3ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAEgAdAB0AHAALgBIAHQAdABwAEMAbABpAGUAbgB0ACgAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAYwBsAGkAZQBuAHQALgBEAGUAZgBhAHUAbAB0AFIAZQBxAHUAZQBzAHQASABlAGEAZABlAHIAcwAuAEEAZABkACgAIgB4AC0AZABhAHQAYQAtAGMAbwBsAGwAZQBjAHQAbwByAC0AdABvAGsAZQBuACIALAAgAHQAbwBrAGUAbgApADsADQAKAA0ACgAgACAAIAAgACAAIAAgACAAIABUAGEAcwBrADwASAB0AHQAcABSAGUAcwBwAG8AbgBzAGUATQBlAHMAcwBhAGcAZQA+ACAAcgBlAHMAcABvAG4AcwBlACAAPQAgAGMAbABpAGUAbgB0AC4ARwBlAHQAQQBzAHkAbgBjACgAbgBlAHcAIABVAHIAaQAoAHUAcgBsACkAKQA7AA0ACgANAAoAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAcgBlAHMAcABvAG4AcwBlAC4AUgBlAHMAdQBsAHQALgBJAHMAUwB1AGMAYwBlAHMAcwBTAHQAYQB0AHUAcwBDAG8AZABlACkADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAbgBvAGQAZQBDAG8AdQBuAHQAIAA9ACAAcgBlAHMAcABvAG4AcwBlAC4AUgBlAHMAdQBsAHQALgBDAG8AbgB0AGUAbgB0AC4AUgBlAGEAZABBAHMAQQBzAHkAbgBjADwATgBvAGQAZQBDAG8AdQBuAHQAPgAoACkALgBSAGUAcwB1AGwAdAA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9AA0ACgANAAoAIAAgACAAIAAgACAAIAAgAEMAbwBuAHMAbwBsAGUALgBXAHIAaQB0AGUATABpAG4AZQAoACIAUgBlAHQAdQByAG4AIABSAGUAcwB1AGwAdAA6ACAAIgAgACsAIAByAGUAcwBwAG8AbgBzAGUALgBSAGUAcwB1AGwAdAAuAEMAbwBuAHQAZQBuAHQAKQA7AA0ACgAgACAAIAAgAH0ADQAKACAAIAAgACAAYwBhAHQAYwBoACAAKABFAHgAYwBlAHAAdABpAG8AbgAgAGUAeABjAGUAcAApAA0ACgAgACAAIAAgAHsADQAKACAAIAAgACAAIAAgACAAIABDAG8AbgBzAG8AbABlAC4AVwByAGkAdABlAEwAaQBuAGUAKAAiAEEAUABJACAAUABvAHMAdAAgAEUAeABjAGUAcAB0AGkAbwBuADoAIAAiACAAKwAgAGUAeABjAGUAcAAuAE0AZQBzAHMAYQBnAGUAKQA7AA0ACgAgACAAIAAgAH0AIAANAAoAIAAgACAAIAByAGUAdAB1AHIAbgAgAG4AbwBkAGUAQwBvAHUAbgB0ADsADQAKAH0ADQAKAA0ACgBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAcwB0AHIAaQBuAGcAIABHAGUAdABTAHQAcgBpAG4AZwBEAGEAdABhACgAVAByAGEAYwBlAFcAcgBpAHQAZQByACAAbABvAGcALAAgAHMAdAByAGkAbgBnACAAYQB1AHQAbwBtAGEAdABlAF8AZgBxAGQAbgAsACAAcwB0AHIAaQBuAGcAIAB0AG8AawBlAG4AKQANAAoAewANAAoAIAAgACAAIAANAAoAIAAgACAAIABzAHQAcgBpAG4AZwAgAG4AbwBkAGUAQwBvAHUAbgB0ACAAPQAgACIAdQBuAGMAaABhAG4AZwBlAGQAIgA7AA0ACgAgACAAIAAgAHQAcgB5AA0ACgAgACAAIAAgAHsADQAKACAAIAAgACAAIAAgACAAIABTAGUAcgB2AGkAYwBlAFAAbwBpAG4AdABNAGEAbgBhAGcAZQByAC4AUwBlAHIAdgBlAHIAQwBlAHIAdABpAGYAaQBjAGEAdABlAFYAYQBsAGkAZABhAHQAaQBvAG4AQwBhAGwAbABiAGEAYwBrACAAKwA9ACAAKABzAGUAbgBkAGUAcgAsACAAYwBlAHIAdAAsACAAYwBoAGEAaQBuACwAIABzAHMAbABQAG8AbABpAGMAeQBFAHIAcgBvAHIAcwApACAAPQA+ACAAdAByAHUAZQA7AA0ACgAgACAAIAAgACAAIAAgACAAcwB0AHIAaQBuAGcAIAB1AHIAbAAgAD0AIABTAHQAcgBpAG4AZwAuAGYAbwByAG0AYQB0ACgAIgBoAHQAdABwAHMAOgAvAC8AewAwAH0ALwBhAHAAaQAvAHYAMAAvAGMAZgBnAG0AZwBtAHQALwBzAHQAYQB0AHMALwBuAG8AZABlAF8AYwBvAHUAbgB0AHMAIgAsACAAYQB1AHQAbwBtAGEAdABlAF8AZgBxAGQAbgApADsADQAKACAAIAAgACAAIAAgACAAIABsAG8AZwAuAEkAbgBmAG8AKAAiAFAAUgBFAFAAQQBSAEkATgBHACAAUgBFAFEAVQBFAFMAVAA9AD0APQA9AD0APQAiACkAOwANAAoAIAAgACAAIAAgACAAIAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBIAHQAdABwAC4ASAB0AHQAcABDAGwAaQBlAG4AdAAgAGMAbABpAGUAbgB0ACAAPQAgAG4AZQB3ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAEgAdAB0AHAALgBIAHQAdABwAEMAbABpAGUAbgB0ACgAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAYwBsAGkAZQBuAHQALgBEAGUAZgBhAHUAbAB0AFIAZQBxAHUAZQBzAHQASABlAGEAZABlAHIAcwAuAEEAZABkACgAIgB4AC0AZABhAHQAYQAtAGMAbwBsAGwAZQBjAHQAbwByAC0AdABvAGsAZQBuACIALAAgAHQAbwBrAGUAbgApADsADQAKAA0ACgAgACAAIAAgACAAIAAgACAAVABhAHMAawA8AEgAdAB0AHAAUgBlAHMAcABvAG4AcwBlAE0AZQBzAHMAYQBnAGUAPgAgAHIAZQBzAHAAbwBuAHMAZQAgAD0AIABjAGwAaQBlAG4AdAAuAEcAZQB0AEEAcwB5AG4AYwAoAG4AZQB3ACAAVQByAGkAKAB1AHIAbAApACkAOwANAAoADQAKACAAIAAgACAAIAAgACAAIABpAGYAIAAoAHIAZQBzAHAAbwBuAHMAZQAuAFIAZQBzAHUAbAB0AC4ASQBzAFMAdQBjAGMAZQBzAHMAUwB0AGEAdAB1AHMAQwBvAGQAZQApAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAG4AbwBkAGUAQwBvAHUAbgB0ACAAPQAgAHIAZQBzAHAAbwBuAHMAZQAuAFIAZQBzAHUAbAB0AC4AQwBvAG4AdABlAG4AdAAuAFIAZQBhAGQAQQBzAFMAdAByAGkAbgBnAEEAcwB5AG4AYwAoACkALgBSAGUAcwB1AGwAdAA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9AA0ACgANAAoAIAAgACAAIAAgACAAIAAgAGwAbwBnAC4ASQBuAGYAbwAoACIAUgBlAHQAdQByAG4AIABSAGUAcwB1AGwAdAA6ACAAIgAgACsAIAByAGUAcwBwAG8AbgBzAGUALgBSAGUAcwB1AGwAdAAuAEMAbwBuAHQAZQBuAHQAKQA7AA0ACgAgACAAIAAgAH0ADQAKACAAIAAgACAAYwBhAHQAYwBoACAAKABFAHgAYwBlAHAAdABpAG8AbgAgAGUAeABjAGUAcAApAA0ACgAgACAAIAAgAHsADQAKACAAIAAgACAAIAAgACAAIABsAG8AZwAuAEkAbgBmAG8AKAAiAEEAUABJACAARwBlAHQAIABFAHgAYwBlAHAAdABpAG8AbgA6ACAAIgAgACsAIABlAHgAYwBlAHAALgBNAGUAcwBzAGEAZwBlACkAOwANAAoAIAAgACAAIAAgACAAIAAgAG4AbwBkAGUAQwBvAHUAbgB0ACAAPQAgACIAZgBhAGkAbABlAGQAIgA7AA0ACgAgACAAIAAgAH0AIAANAAoAIAAgACAAIAByAGUAdAB1AHIAbgAgAG4AbwBkAGUAQwBvAHUAbgB0ADsADQAKAH0ADQAKAA0ACgBwAHUAYgBsAGkAYwAgAGMAbABhAHMAcwAgAEMAbwBuAGYAaQBnAEsAVgAgADoAIABUAGEAYgBsAGUARQBuAHQAaQB0AHkAIAB7AA0ACgAgACAAIAAgAHAAdQBiAGwAaQBjACAAcwB0AHIAaQBuAGcAIABWAGEAbAB1AGUAIAB7ACAAZwBlAHQAOwAgAHMAZQB0ADsAIAB9AA0ACgB9AA==",
            "constants_csx": "cwB0AGEAdABpAGMAIABzAHQAcgBpAG4AZwAgAFAAYQByAHQAaQB0AGkAbwBuAEsAZQB5ACAAPQAgACIAQwBoAGUAZgBBAE0AQQAiADsADQAKAHMAdABhAHQAaQBjACAAcwB0AHIAaQBuAGcAIABBAHUAdABvAG0AYQB0AGUAVABvAGsAZQBuAEsAZQB5AE4AYQBtAGUAIAA9ACAAIgBhAHUAdABvAG0AYQB0AGUAXwB0AG8AawBlAG4AIgA7AA0ACgBzAHQAYQB0AGkAYwAgAHMAdAByAGkAbgBnACAAQQB1AHQAbwBtAGEAdABlAEYAUQBEAE4ASwBlAHkATgBhAG0AZQAgAD0AIAAiAGEAdQB0AG8AbQBhAHQAZQBfAGYAcQBkAG4AIgA7AA=="
        },
        "logAnalytics": {
            "workspace_id": "[parameters('logAnalyticsWorkspaceId')]",
            "shared_key": "[parameters('logAnalyticsSharedKey')]"
        }
    },
    "resources": [
        {
            "type": "Microsoft.Web/sites/functions",
            "name": "[concat(variables('name').site, '/', variables('name').function)]",
            "apiVersion": "[variables('apiVersions').functions]",
            "properties": {
                "config": {
                    "bindings": [
                        {
                            "name": "myTimer",
                            "type": "timerTrigger",
                            "direction": "in",
                            "schedule": "0 */5 * * * *"
                        },
                        {
                            "type": "table",
                            "name": "settingTable",
                            "tableName": "settings",
                            "take": 50,
                            "connection": "AzureWebJobsDashboard",
                            "direction": "in"
                        }
                    ],
                    "disabled": false
                },
                "files": {
                    "run.csx": "[base64ToString(variables('code').run_csx)]",
                    "constants.csx": "[base64ToString(variables('code').constants_csx)]",
                    "workspace.csx": "[concat('static string customerId = \"', variables('logAnalytics').workspace_id, '\";\nstatic string shareKey = \"', variables('logAnalytics').shared_key, '\";')]"
                }
            }
        }
    ],
    "outputs": {
        "apiKey": {
            "type": "string",
            "value": "[listsecrets(resourceId('Microsoft.Web/sites/functions', variables('name').site, variables('name').function), '2016-08-01').key]"
        }
    }
}